(function(){var e={requires:[]};window.require&&e.requires.push(window.require),"undefined"!=typeof r&&null!==r&&e.requires.push(r),function(){"use strict";var r={},t={},n=function(e,r){return{}.hasOwnProperty.call(e,r)},o=function(e,r){var t,n,o=[];t=/^\.\.?(\/|$)/.test(r)?[e,r].join("/").split("/"):r.split("/");for(var i=0,s=t.length;s>i;i++)n=t[i],".."===n?o.pop():"."!==n&&""!==n&&o.push(n);return o.join("/")},i=function(e){return e.split("/").slice(0,-1).join("/")},s=function(r){var t=function(t){var n=i(r),s=o(n,t);return e.require(s,r)};return t.register=e.require.register,t.shim=e.require.shim,t},u=function(e,r){var n={id:e,exports:{}};return t[e]=n,r(n.exports,s(e),n),n.exports},a=function(e,i){var s=o(e,".");if(null==i&&(i="/"),n(t,s))return t[s].exports;if(n(r,s))return u(s,r[s]);var a=o(s,"./index");if(n(t,a))return t[a].exports;if(n(r,a))return u(a,r[a]);throw new Error('Cannot find module "'+e+'" from "'+i+'"')},l=function(e,t){if("object"==typeof e)for(var o in e)n(e,o)&&(r[o]=e[o]);else r[e]=t},c=Object.prototype.toString,p=function(e){return"[object Array]"===c.call(e)},f=function(r){if("undefined"!=typeof window){p(r)||(r=[r]);for(var t=function(r){var t;try{if(e.require(r.path))return}catch(n){}try{for(var o=0,i=e.requires.length;i>o&&!(t=e.requires[o](r.path));o++);}catch(n){}if(!t&&r.symbol){var s=r.symbol.split(".");t=window;for(var u=0,a=s.length;a>u&&(t=t[s[u]]);u++);}if(!t){if(r.optional)return;throw new Error("Missing dependency: "+r.path)}e.require.register(r.path,function(e,r,n){return n.exports=t}),r.alias&&e.require.register(r.alias,function(e,r,n){return n.exports=t})},n=0,o=r.length;o>n;n++)t(r[n])}};e.require=a,e.require.register=l,e.require.shim=f}.call(this);var r=e.require;r.register("cursor",function(e,r,t){var n,o,i,s,u,a={}.hasOwnProperty,l=function(e,r){function t(){this.constructor=e}for(var n in r)a.call(r,n)&&(e[n]=r[n]);return t.prototype=r.prototype,e.prototype=new t,e.__super__=r.prototype,e};u=r("underscore"),n=r("backbone-orm").Cursor,i=r("backbone-orm").JSONUtils,s=r("backbone-orm").Utils,t.exports=o=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return l(r,e),r.prototype.toJSON=function(e){var r,t;return this.hasCursorQuery("$zero")?e(null,this.hasCursorQuery("$one")?null:[]):(t=this.request.get(this.url).query(r=i.toQuery(u.extend(u.clone(this._find),this._cursor))).type("json"),this.sync.beforeSend(t,null),t.end(function(t){return function(n,o){var u;return n?e(n):r.$one&&404===o.status?e(null,null):o.ok?(u=i.parse(o.body),e(null,t.hasCursorQuery("$count")||t.hasCursorQuery("$exists")?u.result:u)):e(new Error("Ajax failed with status "+o.status+" with: "+s.inspect(o.body)))}}(this)))},r}(n)}),r.register("index",function(e,r,t){var n,o,i,s,u;for("undefined"!=typeof window&&null!==window&&r.shim&&r.shim([{symbol:"_",path:"lodash",alias:"underscore",optional:!0},{symbol:"_",path:"underscore"},{symbol:"Backbone",path:"backbone"},{symbol:"moment",path:"moment"},{symbol:"stream",path:"stream",optional:!0},{symbol:"BackboneORM",path:"backbone-orm"},{symbol:"superagent",path:"superagent"}]),t.exports={sync:r("./sync"),modules:{"backbone-orm":n=r("backbone-orm"),superagent:r("superagent")}},u=["url","querystring","lru-cache","underscore","backbone","moment","inflection","stream"],i=0,s=u.length;s>i;i++)o=u[i],t.exports.modules[o]=n.modules[o]}),r.register("sync",function(e,r,t){var n,o,i,s,u,a,l,c,p;p=r("underscore"),n=r("backbone"),c=r("backbone-orm"),a=c.Schema,l=c.Utils,s=c.JSONUtils,u=c.CacheSingletons.ModelCache,o=r("./cursor"),i=function(){function e(e,t){if(this.model_type=e,null==t&&(t={}),!t.beforeSend||(this._beforeSend=t.beforeSend),this.model_type.model_name=l.findOrGenerateModelName(this.model_type),!(this.url=p.result(new this.model_type,"url")))throw new Error("Missing url for model: "+this.model_type);this.schema=new a(this.model_type),this.request=r("superagent")}return e.prototype.initialize=function(){return this.is_initialized?void 0:(this.is_initialized=!0,this.schema.initialize())},e.prototype.resetSchema=function(e,r){var t;return t=this.request.del(this.url),this.beforeSend(t,null,e),t.end(function(e,t){return e?r(e):t.ok?r():r(new Error("Ajax failed with status "+t.status+" for destroy with: "+l.inspect(t.body)))})},e.prototype.cursor=function(e){return null==e&&(e={}),new o(e,{model_type:this.model_type,url:this.url,request:this.request,sync:this})},e.prototype.destroy=function(e,r){var t;return t=this.request.del(this.url).query(e),this.beforeSend(t,null),t.end(function(e,t){return e?r(e):t.ok?r():r(new Error("Ajax failed with status "+t.status+" for destroy with: "+l.inspect(t.body)))})},e.prototype.beforeSend=function(e,r,t){return null==t&&(t={}),!t.beforeSend||t.beforeSend(e,r,t,this),!this._beforeSend||this._beforeSend(e,r,t,this)},e}(),t.exports=function(e,r){var n,o,a;return l.isCollection(new e)?(n=l.configureCollectionModelType(e,t.exports,r),e.prototype.sync=n.prototype.sync):(o=new i(e,r),e.prototype.sync=a=function(e,r,n){var i,u,a;if(null==n&&(n={}),o.initialize(),"createSync"===e)return t.exports.apply(null,Array.prototype.slice.call(arguments,1));if("sync"===e)return o;if("schema"===e)return o.schema;if("isRemote"===e)return!0;if(p.contains(["create","update","patch","delete","read"],e)){if(!(a=n.url||p.result(r,"url")))throw new Error("Missing url for model");switch(u=o.request,e){case"read":i=u.get(a).query({$one:!r.models}).type("json");break;case"create":i=u.post(a).send(n.attrs||r.toJSON(n)).type("json");break;case"update":i=u.put(a).send(n.attrs||r.toJSON(n)).type("json");break;case"patch":i=u.patch(a).send(n.attrs||r.toJSON(n)).type("json");break;case"delete":i=u.del(a)}return o.beforeSend(i,r,n),void i.end(function(r,t){return r?n.error(r):t.ok?n.success(s.parse(t.body)):n.error(new Error("Ajax failed with status "+t.status+" for "+e+" with: "+l.inspect(t.body)))})}return o[e]?o[e].apply(o,Array.prototype.slice.call(arguments,1)):void 0},l.configureModelType(e),u.configureSync(e,a))}}),"function"==typeof define&&define.amd?define(["require","backbone-orm","superagent"],function(){return r("index")}):"object"==typeof exports?module.exports=r("index"):this.BackboneHTTP=r("index")}).call(this);